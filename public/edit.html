<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Edit Post - wryte</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-white text-black min-h-screen font-sans">

  <nav class="border-b border-gray-200 bg-white">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <div class="flex items-center">
          <a href="index.html" class="text-2xl font-bold" style="font-family: 'Dancing Script', cursive;">wryte</a>
        </div>
        <div class="flex space-x-8">
          <a href="index.html" class="text-sm font-medium text-gray-700 hover:text-black transition-colors">Home</a>
          <a href="dashboard.html" class="text-sm font-medium text-gray-700 hover:text-black transition-colors">Dashboard</a>
          <a href="login.html" class="text-sm font-medium text-gray-700 hover:text-black transition-colors">Login</a>
        </div>
      </div>
    </div>
  </nav>


  <div class="max-w-2xl mx-auto px-4 py-12">
    <div class="text-center mb-8">
      <h1 class="text-2xl font-bold text-black mb-2">Edit Post</h1>
      <p class="text-sm text-gray-600">Update your blog post content</p>
    </div>

    <div class="bg-white border border-gray-200 rounded-lg p-6">
      <form id="editForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Title</label>
          <input 
            name="title" 
            required 
            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-black focus:border-black transition-colors"
            placeholder="Enter post title"
          >
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Content</label>
          <textarea 
            name="content" 
            required 
            rows="12"
            class="w-full px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-black focus:border-black transition-colors resize-vertical"
            placeholder="Write your post content..."
          ></textarea>
        </div>
        
        <div class="flex items-center">
          <input 
            type="checkbox" 
            name="published" 
            id="published"
            class="h-4 w-4 text-black focus:ring-black border-gray-300 rounded"
          >
          <label for="published" class="ml-2 text-sm text-gray-700">Published</label>
        </div>
        
        <div class="flex gap-3 pt-2">
          <button 
            type="submit"
            class="px-4 py-2 text-sm font-medium text-white bg-black rounded-md hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 transition-colors"
          >
            Save Changes
          </button>
          <a 
            href="dashboard.html"
            class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-black focus:ring-offset-2 transition-colors"
          >
            Cancel
          </a>
        </div>
      </form>
    </div>
  </div>

  <script>
    const params = new URLSearchParams(location.search);
    const id = params.get('id');

    fetch('/api/posts/'+id)
      .then(r=>r.json())
      .then(post=>{
        const f=document.getElementById('editForm');
        f.title.value=post.title;
        f.content.value=post.content;
        f.published.checked=post.published;
      });

    document.getElementById('editForm').onsubmit=async (e)=>{
      e.preventDefault();
      const fd=new FormData(e.target);
      const data=Object.fromEntries(fd);
      data.published=fd.has('published');
      const res=await fetch('/api/posts/'+id,{
        method:'PUT',
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify(data)
      });
      if(res.ok) window.location='dashboard.html';
      else alert('Failed to update post');
    };
  </script>
</body>
</html>
